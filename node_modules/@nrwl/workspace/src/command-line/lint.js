"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const project_graph_1 = require("../core/project-graph");
const workspace_integrity_checks_1 = require("./workspace-integrity-checks");
const path = require("path");
const app_root_1 = require("../utils/app-root");
const file_utils_1 = require("../core/file-utils");
const output_1 = require("../utils/output");
function workspaceLint() {
    const graph = project_graph_1.onlyWorkspaceProjects(project_graph_1.createProjectGraph());
    const cliErrorOutputConfigs = new workspace_integrity_checks_1.WorkspaceIntegrityChecks(graph, readAllFilesFromAppsAndLibs()).run();
    if (cliErrorOutputConfigs.length > 0) {
        cliErrorOutputConfigs.forEach((errorConfig) => {
            output_1.output.error(errorConfig);
        });
        process.exit(1);
    }
}
exports.workspaceLint = workspaceLint;
function readAllFilesFromAppsAndLibs() {
    return [
        ...file_utils_1.allFilesInDir(`${app_root_1.appRootPath}/apps`).map((f) => f.file),
        ...file_utils_1.allFilesInDir(`${app_root_1.appRootPath}/libs`).map((f) => f.file),
    ].filter((f) => !path.basename(f).startsWith('.'));
}
//# sourceMappingURL=lint.js.map